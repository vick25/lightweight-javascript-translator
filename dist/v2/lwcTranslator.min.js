"use strict";function _instanceof(e,t){return null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?t[Symbol.hasInstance](e):e instanceof t}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!_instanceof(e,t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}
/**
 * @author codingsamuel
 * @license MIT
 * @version 2.0.1
 * @copyright codingsamuel 2019
 */var LwcTranslator=function(){function t(e){_classCallCheck(this,t),this.settings={querySelector:e.querySelector||"html",translationSettings:e.translationSettings||"/assets/config/translations.json",translationFolder:e.translationFolder||"/assets/config/translations/",currentLanguageKey:e.currentLanguageKey||"currLang",initialLanguageCode:e.initialLanguageCode||"en-GB",onTranslationSettingsLoaded:e.onTranslationSettingsLoaded||function(){},onTranslationLoaded:e.onTranslationLoaded||function(){},onError:e.onError||function(){}},this.init()}return _createClass(t,[{key:"_contains",value:function(t){try{var r=document.querySelectorAll("*");return[].filter.call(r,function(e){return RegExp(t).test(e.textContent)})}catch(t){this.settings.onError.call(this._handleError(e))}}},{key:"_replaceAll",value:function(e,t,r){try{return e.split(t).join(r)}catch(e){this.settings.onError.call(this._handleError(e))}}},{key:"_prepareRequest",value:function(e){try{var t=new XMLHttpRequest;return t.open("GET",e),t.send(),t}catch(e){this.settings.onError.call(this,e)}}},{key:"_handleError",value:function(e){try{var t={originalError:Object,handleError:String,errorCode:Number};return"string"==typeof e?(t.originalError=e,t.handleError=e,t.errorCode=400):"object"===_typeof(e)&&(t.originalError=e,e.message?(t.handleError=e.message,t.errorCode=400):e.status&&e.response?(t.handleError=e.responseText,t.errorCode=e.status):(t.handleError=e,t.errorCode=400)),t}catch(e){console.error(e)}}},{key:"_loadTranslationFile",value:function(e,t){var r=this;try{var n=this.getCurrentLanguage();if((t.translations||[]).filter(function(e){return e===n.langCode})[0]){var a=this._prepareRequest(this.settings.translationFolder+e+"/"+t.dir+"/"+n.langCode+".json");a.onreadystatechange=function(e){if(4===a.readyState&&200===a.status){var t=JSON.parse(a.responseText),n=t.content;r.translate(n),r.settings.onTranslationLoaded.call(r,t)}else 4===a.readyState&&r.settings.onError.call(r,r._handleError(a))}}else this.settings.onError.call(this,this._handleError("No translation found for page ["+page.dir+"]!"))}catch(e){this.settings.onError.call(this,this._handleError(e))}}},{key:"setRegex",value:function(e){this._regex=e}},{key:"getRegex",value:function(){return this._regex}},{key:"setSupportedLanguages",value:function(e){this._supportedLanguages=e}},{key:"getSupportedLanguages",value:function(){return this._supportedLanguages}},{key:"setCurrentLanguage",value:function(e){var t={name:"English",langShort:"en",langCode:"en-GB"};window.localStorage.setItem(this.settings.currentLanguageKey,JSON.stringify(this.getSupportedLanguages()&&this.getSupportedLanguages().filter(function(t){return t.langCode===e})[0]||t))}},{key:"getCurrentLanguage",value:function(){var e=window.localStorage.getItem(this.settings.currentLanguageKey);return e?JSON.parse(e):void 0}},{key:"getCurrentPage",value:function(){var e=location.pathname;return e=e.substring(1,e.lastIndexOf("."))}},{key:"init",value:function(){try{var e=this.settings;this.load(e.translationSettings)}catch(e){this.settings.onError.call(this,e)}}},{key:"load",value:function(e){var t=this;try{var r=this._prepareRequest(e);r.onreadystatechange=function(e){if(4===r.readyState&&200===r.status){var n=JSON.parse(r.responseText);t.setSupportedLanguages(n.supported),t.setRegex(n.regex||"\\{\\{(.*?)\\}\\}"),t.getCurrentLanguage()||t.setCurrentLanguage(t.settings.initialLanguageCode);var a=t.getCurrentPage(),o=n.pagesDir||"pages",s=n.partialsDir||"partials",i=(n.pages||[]).filter(function(e){return e.dir===a})[0];if(i){var l=n.partials||[],u=i.partials||[],g=(h=[],u.forEach(function(e,t){var r=l.filter(function(t){return t.dir===e})[0];r&&h.push(r)}),h);if(g.length!=u.length)t.settings.onError.call(t,t._handleError("Not all Partials for the page ["+a+"] were found. Please check your settings file!"));else for(var c=0;c<g.length;c++)t._loadTranslationFile(s,g[c]);t._loadTranslationFile(o,i)}else t.settings.onError.call(t,t._handleError("Page ["+a+"] not found in settings!"));t.settings.onTranslationSettingsLoaded.call(t,n)}else 4===r.readyState&&t.settings.onError.call(t,t._handleError(r));var h}}catch(e){this.settings.onError.call(this,e)}}},{key:"translate",value:function(e){var t=this;try{var r=this.getCurrentLanguage();if(e){var n=document.querySelector(this.settings.querySelector);document.querySelector("html").setAttribute("lang",r.langShort);var a=new RegExp(this.getRegex(),"g");n.innerHTML.match(a).forEach(function(r,o){var s=(a=new RegExp(t.getRegex(),"g")).exec(r);if(s){var i=s[1].split("."),l=e;i.forEach(function(e){l=l[e]}),n.innerHTML=t._replaceAll(n.innerHTML,r,l)}})}else this.settings.onError.call(this,this._handleError("translation content is not defined. Please check your translation file for ["+r.langCode+".json]"))}catch(e){this.settings.onError.call(this,e)}}}]),t}();