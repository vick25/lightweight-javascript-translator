"use strict";function _instanceof(t,e){return null!=e&&"undefined"!=typeof Symbol&&e[Symbol.hasInstance]?e[Symbol.hasInstance](t):t instanceof e}function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!_instanceof(t,e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}
/**
 * @author codingsamuel
 * @license MIT
 * @version 2.1.0
 * @copyright codingsamuel 2019
 */var LwcTranslator=function(){function t(e){_classCallCheck(this,t),this.settings={querySelector:e.querySelector||"html",translationSettings:e.translationSettings||"/assets/config/translations.json",translationFolder:e.translationFolder||"/assets/config/translations/",initialLanguageCode:e.initialLanguageCode||"en-GB",onTranslationSettingsLoaded:e.onTranslationSettingsLoaded||function(){},onTranslationLoaded:e.onTranslationLoaded||function(){},onError:e.onError||function(){},store:{useCustom:Boolean,key:String,mode:String,customCallback:{get:Function,set:Function}}},e.store?this.settings.store={useCustom:e.store.useCustom||!1,key:e.store.key||"currLang",mode:e.store.mode||"localStorage",customCallback:e.store.customCallback?{get:e.store.customCallback.get||function(){},set:e.store.customCallback.set||function(){}}:{get:function(){},set:function(){}}}:this.settings.store={useCustom:!1,key:"currLang",mode:"localStorage",customCallback:{get:function(){},set:function(){}}},this.init()}return _createClass(t,[{key:"_contains",value:function(t){try{var r=document.querySelectorAll("*");return[].filter.call(r,function(e){return RegExp(t).test(e.textContent)})}catch(t){this.settings.onError.call(this._handleError(e))}}},{key:"_replaceAll",value:function(t,e,r){try{return t.split(e).join(r)}catch(t){this.settings.onError.call(this._handleError(t))}}},{key:"_prepareRequest",value:function(t){try{var e=new XMLHttpRequest;return e.open("GET",t),e.send(),e}catch(t){this.settings.onError.call(this,t)}}},{key:"_handleError",value:function(t){try{var e={originalError:Object,handleError:String,errorCode:Number};return"string"==typeof t?(e.originalError=t,e.handleError=t,e.errorCode=400):"object"===_typeof(t)&&(e.originalError=t,t.message?(e.handleError=t.message,e.errorCode=400):t.status&&t.response?(e.handleError=t.responseText,e.errorCode=t.status):(e.handleError=t,e.errorCode=400)),e}catch(t){console.error(t)}}},{key:"_loadTranslationFile",value:function(t,e){var r=this;try{var n=this.getCurrentLanguage();if((e.translations||[]).filter(function(t){return t===n.langCode})[0]){var o=this._prepareRequest(this.settings.translationFolder+t+"/"+e.dir+"/"+n.langCode+".json");o.onreadystatechange=function(t){if(4===o.readyState&&200===o.status){var e=JSON.parse(o.responseText),n=e.content;r.translate(n),r.settings.onTranslationLoaded.call(r,e)}else 4===o.readyState&&r.settings.onError.call(r,r._handleError(o))}}else this.settings.onError.call(this,this._handleError("No translation found for page ["+page.dir+"]!"))}catch(t){this.settings.onError.call(this,this._handleError(t))}}},{key:"setRegex",value:function(t){this._regex=t}},{key:"getRegex",value:function(){return this._regex}},{key:"setSupportedLanguages",value:function(t){this._supportedLanguages=t}},{key:"getSupportedLanguages",value:function(){return this._supportedLanguages}},{key:"setCurrentLanguage",value:function(t){if(this.settings.store.useCustom)this.settings.store.customCallback.set.call(this,t);else{var e={name:"English",langShort:"en",langCode:"en-GB"},r=JSON.stringify(this.getSupportedLanguages()&&this.getSupportedLanguages().filter(function(e){return e.langCode===t})[0]||e);switch(this.settings.store.mode){case"localStorage":window.localStorage.setItem(this.settings.store.key,r);break;case"cookie":document.cookie=this.settings.store.key+"="+r+";path=/"}}}},{key:"getCurrentLanguage",value:function(){var t,e=this;if(this.settings.store.useCustom)return this.settings.store.customCallback.get.call(this);switch(this.settings.store.mode){case"localStorage":t=window.localStorage.getItem(this.settings.store.key);break;case"cookie":document.cookie.split(";").forEach(function(r,n){var o=r.split("=");o[0]===e.settings.store.key&&(t=o[1])})}return t?JSON.parse(t):{name:void 0,langShort:void 0,langCode:void 0}}},{key:"getCurrentPage",value:function(){var t=location.pathname;return t=t.substring(1,t.lastIndexOf("."))}},{key:"init",value:function(){try{var t=this.settings;this.load(t.translationSettings)}catch(t){this.settings.onError.call(this,t)}}},{key:"load",value:function(t){var e=this;try{var r=this._prepareRequest(t);r.onreadystatechange=function(t){if(4===r.readyState&&200===r.status){var n=JSON.parse(r.responseText);e.setSupportedLanguages(n.supported),e.setRegex(n.regex||"\\{\\{(.*?)\\}\\}"),e.getCurrentLanguage()||e.setCurrentLanguage(e.settings.initialLanguageCode);var o=e.getCurrentPage(),s=n.pagesDir||"pages",a=n.partialsDir||"partials",i=(n.pages||[]).filter(function(t){return t.dir===o})[0];if(i){var l=n.partials||[],u=i.partials||[],c=(h=[],u.forEach(function(t,e){var r=l.filter(function(e){return e.dir===t})[0];r&&h.push(r)}),h);if(c.length!=u.length)e.settings.onError.call(e,e._handleError("Not all Partials for the page ["+o+"] were found. Please check your settings file!"));else for(var g=0;g<c.length;g++)e._loadTranslationFile(a,c[g]);e._loadTranslationFile(s,i)}else e.settings.onError.call(e,e._handleError("Page ["+o+"] not found in settings!"));e.settings.onTranslationSettingsLoaded.call(e,n)}else 4===r.readyState&&e.settings.onError.call(e,e._handleError(r));var h}}catch(t){this.settings.onError.call(this,t)}}},{key:"translate",value:function(t){var e=this;try{var r=this.getCurrentLanguage();if(t){var n=document.querySelector(this.settings.querySelector);document.querySelector("html").setAttribute("lang",r.langShort);var o=new RegExp(this.getRegex(),"g");n.innerHTML.match(o).forEach(function(r,s){var a=(o=new RegExp(e.getRegex(),"g")).exec(r);if(a){var i=a[1].split("."),l=t;i.forEach(function(t){l=l[t]}),n.innerHTML=e._replaceAll(n.innerHTML,r,l)}})}else this.settings.onError.call(this,this._handleError("translation content is not defined. Please check your translation file for ["+r.langCode+".json]"))}catch(t){this.settings.onError.call(this,t)}}}]),t}();